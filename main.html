<!DOCTYPE html>
<html>
<head>
<title>Welcome Login Form Flat Responsive Widget Template :: w3layouts</title>
<!-- for-mobile-apps -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Welcome Login Form Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, 
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
<script type="application/x-javascript"> addEventListener("load", function() { runme(); }, false);
		function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- //for-mobile-apps -->
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
<script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="cordova.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
<script type="text/javascript" src="js/app/wright.js"></script>
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyAvCB0fJALK-4VaEiubgiVYuh-pJxNGvH0&callback=initMap&libraries=geometry" async defer></script>
<script type="text/javascript">
	 var  config = {
        apiKey: "AIzaSyBeBob8a8BTjNgJ9y5B_tPav8H0WiB_m0o",
        authDomain: "usermodule-465de.firebaseapp.com",
        databaseURL: "https://usermodule-465de.firebaseio.com",
        projectId: "usermodule-465de",
        storageBucket: "usermodule-465de.appspot.com",
        messagingSenderId: "69398739277"
       };
	var rootRef;
	function initMap() {
	}
function runme(){
	debugger;	 
        firebase.initializeApp(config);
        rootRef = firebase.database().ref();		
             rootRef.on('value', function(snapshot){
                if(snapshot.exists()){
                   var colorNo = 0;
                   var arrayObject = [];
                   arrayObject = snapshot.val();                                      
				   var childarray = [];
				   try{
					var deviceid=device.uuid;									   
				   var validcount=0;
				   var person='';	
					   var driver='';	
                    snapshot.forEach(function(data) {                              
						childarray=Object.values(data.val()).toString().split(',');
						if(childarray[1]==deviceid) 
							{
								validcount=1;
								person=childarray[0];
								driver=childarray[2];
								
							}						
                     });
					if(validcount==1)
						{
							alert("Welcome :"+person);
							if(person=='Driver')
								{
									document.getElementById("person").innerHTML=person;
									document.getElementById("driver").style.display = 'block';
								}
							if(person=='Student')
								{
									document.getElementById("person").innerHTML=person;
									document.getElementById("student").style.display = 'block';
									document.getElementById("hiddenspan").innerHTML=driver;
								}
							watchuserPosition();
														
						}
					else
					{
						document.getElementById("person").innerHTML=" Visitor.."+""+" Contact Administrator to add your details"+deviceid;
					}
                }
					catch(err)
						{
							alert(err.message);
						}
				}
            });
	
	}
	function clickgo()
	{
		
		var qs=document.getElementById("hiddenspan").innerHTML;
		var cor=document.getElementById("locationid").innerHTML.split(',');
		window.location.href="tracking.html?idval="+qs+"&lat="+cor[0]+"&long="+cor[1];
		
	}
</script>
</head>
<body>
	<!-- main -->
		<div class="main">
			<h1 style="font-size:60px">Welcome <span id="person"></span> </h1>
			<form>				
				<a href="index.html" id="driver" Style="display:none;width: 100%;padding:5px;
    background-color: #f54890;color: #f3eded;">Start Track</a>				
				<a  id="student" onclick="clickgo();" Style="display:none;width: 100%;padding:5px;
    background-color: #f54890;color: #f3eded;">Get My Track</a>	
				Driverid:<span id="hiddenspan" style="display:block"></span>
				Capture Location
				<span style = "color:#2e2d2f;display:show;width:100%;text-align: center;font-size: 12px;" ID="locationid"></span>
			</form>
		</div>
		<div class="footer">
			<p>&copy 2018 Welcome NSRIT BUS TRACKING. All rights reserved | Design by <a href="#">NSRIT.</a></p>
		</div>
	<!-- //main -->
</body>
</html>
